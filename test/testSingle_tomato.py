"""
Single sequence inference example on tomato gene (AT1G58150.TAIR10).

Demonstrates basic inference workflow: load model, tokenize sequence,
generate GSF annotation, convert to GFF3.
"""
import torch
from transformers import AutoModel, AutoTokenizer

# Load the model
model_name = "jlomas/HyenaTransgenic-768L12A6-400M"
model = AutoModel.from_pretrained(model_name, trust_remote_code=True)

# Load the output tokenizer
gffTokenizer = AutoTokenizer.from_pretrained(model_name, trust_remote_code=True)

# Load the input tokenizer
dnaTokenizer = AutoTokenizer.from_pretrained("LongSafari/hyenadna-large-1m-seqlen-hf", trust_remote_code=True)


# AT1G58150.TAIR10 gene sequence
seq = 'ATGATCTATTTCGAGAATGATCTTTATCCACGGTAACAGTAAATTCATAAAAATTATTTGCCTTAAACTTACTAAATTTTGCTCATTATTCTGATTAATGTCAACTAGTCTCCAGGATTCAAATATTTGCCCTTCAAAAGCAAACTTTTTCTCTCCAACAAGAGACTTTGTTTTCATGTTAGAATTTTATTATTACTTTACTGTATTATCTTGTTGTATTTTCTGCTTATTGCTACTGCCTTCTTTTACATCTTTTTGTGAGTCGAGAATCTATCGGAAACAACCTCTCAGATCTCCGTATACCCCATCCTCCAAGAAGGCCAGACCCCACCAATGGGACTACACCGAGTTTGCTAGTTAGTTAGTTAGTTAGTTAGTTTCATGAAGTGTTTGTTAGCGTATGAGTGAAGTCATGAGCTCTCTTTGTGACTCAACAAAAATTTCTTTTCATTTGTGTGGAAATAAGTTCAGTCTTATTATTCGTTGACATATTCGACTGATAAAACAGATAATTGGACAGAATTTGAATCTTCACATCACTTAATCTAGAGTTTCCTCATATTATGATCAAACTACTTGACTCGAACGATATATGTGTCATCCTATATATCCTCCCTTCCATGTATGACTAAACTTTAAGGACTATAACGACATGTTTCTTTCGTTCTGCTCTCCGAAAAGACAGAACAGCACTCTCACACTCACCTATAGAAAAAAATGTTAAATCTAGTCGGACTTAATGGACTCCTGCACTGTCTTCCATCAGCTAGTTGATTCTCGTGGAAAATTGGATGGAGGTGGCGCACTATGTAAGGCGCTGTATTAAGAGTAGATTTCCAGTATAAACTTAATGCATTAGCATAGTGACAGTCCTATTCCTAAGTTGTGTAGTGGTCCTATTCCTGGAATCCAATTAAGTTGGCAAAACAAATAAGGTAGCACACAAAATGCATGTATAATGTGTTATATACAAGTAGTGGGACTTTGTCTGTTGACTTAAGAGTGTGAACTATTGATAGTTTCTGGCATTAACTTGTGTGACGCAATAAATGGGCTATATATACATCATCAAAATTGTTGAATAGACACACAAAGCAAACGTTTCTTAATTTCTTCTCTACCAACTTGATTAGGTTTGATCATTTTTAGTGCAGAAATGGATTGTGTAAAACTTGTGTTTTTCATGCTATATACCTTTCTCTGTCAACTTGCTTTCTCCTCATCCTCACCTCATTTATGCCCGATAGATCAAGCTCTTTCTCTTCTACAATTCAAGAACATGTTCAACATTAATCCTAATGCTTCTGATTATTGTTACGACATAAGTACAGGCGTAGAGATTCAGTCATATCCAAGAACTCTTTTCTGGAACAAGAGTACAGATTGTTGCTCATGGGATGGAGTTCACTGTGACAAGATGATAGGACTAGTGATTGAGCTTGATCTCCGTTGCAGCCAACTTCAAGGCAAGTTTCATTCCAATGGTAGCCTCTTTCAACTCTTCAATCTCAAAAGGCTTGATTTGTCTTTTAATAATTTCACCGGATCACTCATTTCACCTAAATTTGGTGAATTCTCTAGTTTGATGCATCTTGATTTGTTGGATTCAGGTTTTACAGGTATAATCCCTTCCGAAATTTGTCACCTTTCTAAACTACGTTCTGCGTATCTCGACTGATTATCCATATGGGCCTCACAATTTTGAACGGCTCCTTAAGAACTTGACCCAATTAAGAGAGCTCCACCTTGAATCTGTCAACATCTCTTCCACTATTCCTTCAAATTTCTCTTCTCATTTAACAAATCTACAACTTTCACGTGCAGAGTTACATGGGATATTGCCCGAAAGAGTTTTTCACCTTTCCAACTTAGAATCCCTTCATTTATCAGACAATCCCCAGCTCACGGTTAGGTTTCCCACAACCAAATGGAATAGCAGTGCATCACTCATGAAGTTATACGTCTATAGTGTGAATATTGCTGATAGGATACCTGAATCATTTAGCCATCTAACTGCACTTCATAAGCTGGACATGGGTTATAATAATCTGTCAGGGCCTATTCCTAAACCTCTATGGAATCTCACCCATATAGAGAGTTTGTTCCTTGATTATAACCATCTTGAAGGACCAATTTCCCATTTCACGATATTTGAAAAGCTCAAGAGGTTATCACTTGGAAATAACAACTTTGATGGCCGTCTTGAGTTCTTATCCTTTAACAGAAGCTGGATGAAGCTTGAAAGGCTAGATTTTTCATCCAATTTCCTAACTGGTCCAATTCCATCCAATGTAAGTGGACTGCAAAACCTACAACAACTCATCTTGTCGTCAAACCACTTGAATGGGACTATACCTTCCTGGATATTCTCCCTTCCTTCACTGACAGTTTTAAACTTGAGTGATAACACTTTGAGTGGAAAAATTCAGGAGTTCAAGTCCAAAATATTGAATGTCGTTTCTCTAAACCAAAATCAGATGGAAGGTCCAATATCAAATTCATTCATAAACCAGACAAGCCTAAGGTTTCTTCTCCTTTCGCACAATAATATAAGTGGACAGATTGCTTCAACTATCTGCAATCTAAAAACACTAATAGTTCTAGATTTGAGAAGTAATAATTTGGAGGGAACAATCCCACAATGTTTGGGTGAGATGAAAGAAAATCTTTGGATTTTGGATTTGAGCAACAACAGCCTTAGTGGGACAATTGATACAACTTTTAGTATTGGAAACTCTTTCAGGGTTATTAGCTTGCATGGGAATAAGCTAACGGGAAAAGTCCCACCATCTTTGATTAATTGCACGTATTTGATACTTCTTGATCTAGGTAATAATCAGTTGAATGACACATTTCCAAACTGGTTGGGAGACCTACCTGATTTGCAGGTTTTAAGCTTGAGATCAAATAAGTTGCATGGTCCCATTAAATCTTCGGGGAATAATATCTGCAATCTGAAAACATTGGAAGTGCTAGATTTGCGAAGCAATAATTTAGAGGGAACAATCCCACATTGTATGGGTGAGATGAGTGCAGTTAAGATTTTGGATTTAAGCAACAATGGTCTTAGTGGGACAATTAATACAACTTTTAGCATTGGAAACACATTCAACATCATTAAATTGGATGGCAACAAGCTACAGGGGAAAGTTCCACCATCTTTGATCAACTGTGAAAAATTGGAATTTCTAGATTTAAGTAACAATGAGTTGAATGACACGTTTCCAAAATGGTTGGGTGGCCTACGGAATTTGAAGATCTTAAATTTGAGATCAAATAAGTTGTATGGCCCTATAAGGACTGACAACTTCTTTGCTCAAATTCGAGTAATAGATATCTCATCCAATGGATTTAGTGGAGATTTACCGGTGAGCTTGTTTCAGAATTTTCAAGCCATGAAAACAAATGGTGAGAATAGTGGAACCTGAAAGTATGTACCAGATATATATTCTTTTTCTTACAATATTTCTTTGATAGTGACTACAAAGGGACTAGATCGTGTAATTCCTCGAATTTTAATTACACAAATACTTATCGATCTCTCAAGGAATAGATTTGAAGGTCATATTCCAAGCATTATTGGAGATCTCGTTGGACTTCGTACCTTAAACTTATCTCATAATGTCTTGGAAGGTCATATACCAGCATCATTGCAAAATCTATCTGTGCTCGAATCATTGGATCTCTCATCCAACAAATTAGATGGTGAAATTCCACAACAACTTGTGTCTCTCACGTCACTTGAAGTCTTAAATCTCTCTCACAATCATCTTGTTGGATGCATCCCCAAAGGAAAACAATTTGATACGTTTGAGAACAATTCCTACCTAGGAAATGATGGATTACGAGGATTGCCACCCTCAAGAGATTGTGGCCGTGATGATCAAGCGACAACTCCAGCTGAGCTAGATCAAGAAGAAGAAGAAGAAGAAGAAGATTCACCAATGATCAGTTGGCAAGCAGTTCTCATGGGTTATGGTTGTGGACTTGTTATTGGACTATCCGTAATATACATAATGTGGTCAACTCAATATCCAGCATGGTTTTCCAGGAGGGATGTAAAATTGGAACACATAATTACTACGAGAATGAAAAAGCACAAGAAAAGATATTAGTGAGTAGTTACCTCCAGGTATTCAACTTGATCATTATCTTTCAGAAGATTATTTTTTATATATCGATGAAATTATCGACCTCCTTCATCCTCAAAGATCTTAACTTTAACTCTTCATTTTTTAAAATTGCAGGATTCAAAGACTTCCGAGTTCCAAGTTGCTGGGGATGCAGATAAAAGCCTTCTTATCTTTCATAGTTTGTAATGTTTCCATGAAGTGTTTCTTATCCTATGAATAAAGATTTTATTTTCATTTGTCTATGGCACGTAGATAGGTTCCGTCACTAAAAACATTGTATTTCTCTCAACTCTTTCGGCACATGATATCAAAGAACACTCGACTTAAATTAAGTTGCTGTAGTCTGCTGTTTTAATTTTTTCCATTGAAACACAACCGACGTATCATGAGAAAGAGACTATGATCTCAGAAATGGGAATCTTCCAATCCAAAACTCAGAAAGTCTAGTATCAAACACACCCGACCCTGCAGCATCTACTGGAACTTTTTTCATCTTACATTTTTTATTACTACCGGTTGTTTCTCTAGCTTCGATTTAGAAAAAAAAACCTCTCTACCTTCAAGGTAGTGGTAAGGTTTGCGTACAGACTATTCTCCCAAGATGGCCAGGCCCCACTGGTGGGAATCGATTACACTGAGTTTGTTTGTTAGCCTATGAAGAACATGCCGTGTCTGGAGTGTCTTCCATCAGTAGGTCAATTCTCATGGAAAATGGGCTCGAGCTGGCGCACTATGTAAGGCGCTGTATTCAGAGTAGATATCCAGTCTACACTTAATGCATTGGCAAAAAGACTGTCCTATATTTAAGATATAAAGTTGTTATGTTTCTTTCAATGTCTATACACCAACTAATTGAGTTGTGTGGTGGTCCTATAGTTTTCGGCATTCACTTGTGTGTCACATTGAATGGGAATATGTGATTCACAAGTTCAAATTGATTGAAAATGACTACGTAACCAATAGTCTATACACCAAGTAAAATAATACTCTTGAGTTGTGTGGTGGTCCTATTCCTGCAATCCAATTAAGTTGGCAAAACAAATAAGGTATCACACAAAATGCATGTGTAATGTGTTATATATGTAAGTGGTGGGGACTTAAGAATGTGAACTATTGATAGTTTCTGGCGTTCACTTGTGTGACACAATCAAAATTGTTGAATAGACACACAAAGCAAACGTTTCTTGATTTCTTCTCTACCAACTTGATTAGTTTTGATCATTTTTAGTGCAGAAATGGGTTGTGTAAAAATTGTGTTTTTTATGCTATATACCTTTCTCTGTCAACTTGCTTTGTCGTCATCCTCACCTCATTTGTGCCCGAAAGATCAAGCTCTTTCTCTGCTACAATTCAAGAACATGTTTACCATTAATCCTGATGCTTCTGATTATTGTGATTCTTCTCATCCAAGAACTCTTTTCTGGAACAAAAGCACAGATTGTTGCTCATGGGATGGAGTTCATTGTGACAAGATGACAGGACAAGTGATTGAGCTTGATCTCCATTGCAGCCACCTTCAAGGCAAGTTTCATTCAAACAGTAGCCTCTTTCAACTCTCCAATCTCAAAAGACTTGATTTTTCTTATAATGATTTCACTGGATCGCCCATTTCACCTAAATTTGGTGAGTTTTCTAGTTTGAGACATCTTGATTTGTCGCGTTCAGGCTTTACTGGTCTAATCCCTTTCTGAAGTCTCTCATCTTTCTAAACTATACGTTCTTCGTATCGGTGATCTAAATGAGCTTAGTCTTGGGCCTTACAATTTTGAACTGCTCCTTAAGAACTTGACCCAATTAAGAGAGCTCCACCTTGAATCTGTCAACATCTCTTCTACTATTCCTTCCAATTTCTCTTCTCATTTAACAACTCTACAACTTTCAGGCACAGAGTTACATGGGATATTGCCCGAAAGATTCTTCCACCTCACCGACTTAGAATCCCTTGATTTATCATTCAATCCCCAGCTCACAGTTAGGTTTCCCACAACCAAATGGAATAGCAGTGCATCACTCATCAAGTTATATCTCTATAATGTGAATTTTACTGGTACGTTACCTGAATCGTTTAGCTATCTAACTGCACTTCATAAGCTGGACATGGGTTATACTAATCTGTCAGGGCCCATTCCTAAACCTCTATGGAATCTCACCAGCATAGAGATTTTGTACCTTGATTATAACCATCTTGAAGGACCAATTTCCCACTCCACGATATTTGAAAAACTCAAGAGGTTATCACTTAGAAATAACAACTTGGATGGCGGACTTGAGTTCTTATCCTTTAACACCCAACTTGAATGGATAGATTTATCATCCAATTCCCTAACTGGTCCAAATCCATCCAACGTAAGCGGACTTCAAAACCTAGAATGGCTCTACTTGTCATCAAACAACTTGAATGGGAGTATACCTTCCTGGATATTCTCCCTTCCTTCATTGATAGAGTTAGACTTGAGCAATAACACTTTCAGTGGAAAAATTCAAGACTTCAAGTCCAAAACATTAAGTGTCGTTTCTCTACGACAAAATCAGCTGGAAGGTCCTATTCCGAATTCACTCCTAAACCAGAGCCTATTTTATCTTGTCCTTTCACACAATAATATCAGTGGACATATTTCTTCATCTATCTGCAATCTGAAAAAAATGATATTGTTAGACTTGGGAAGTAACAATTTGGAGGGAACGATCCCACAATGTGTGGGTGAGATGAAAGAAAACCTTTGGAGTTTGGATTTGAGCAACAACAGACTTAGTGGGACAATCAATACAACTTTTAGTATTGGAAACTCTTTAAGGGTCATTAGCTTGCACGGGAATAAGCTAACCGGGAAAGTCCCACGATCTTTGATCAATTGCAAGTATTTGACACTACTTGATCTAGGTAACAATCAGTTGAATGACACATTTCCAAACTGGTTGGGAAACCTATCTCAATTGAAGATTTTAAACTTGAGATCAAATAAGTTGCATGGTCCCATCAAATCTTCAGGGAATACAAACTTGTTTACGCGTCTTCAAATTCTTGATCTATCATCTAATGGATTTAGTGGGAATTTACCCGAAAGTATTTTGGGGAATTTGCAAGCCATGAAAAAAATTGATGAGAGTACAAGAACACCAGAGTATATTTCTGATATTTATTACAATTATTTGACGACAATTACTACAAAGGGACAAGATTATGATTCTGTTAGAATTTTTACTTCTAACATGATTATCAATCTCTCAAAGAACAGATTTGAAGGTCGTATTCCAAGCACTATTGGAGATCTTGTTGGACTTCGTACGTTGAATTTGTCTCATAATGTCTTGGAAGGTCATATACCGGCATCATTTCAAAATTTATCAGTACTCGAATCATTGGATCTCTCATCTAACAAAATCAGCGGAGCAATTCCGCAGCAGCTTGCATCCCTCACATTCCTTGAAGTCTTAAATCTCTCTCACAATCATCTTGTTGGATGCATCCCCAAAGGAAAACAATTTGATTCGTTCGGGAACAGTTCATACCAAGGGAATGATGGGTTACGCGGATTTCCACTCTCAAAACATTGTGGTGGTGATGATCAAGTGACAACTCCAGCTGAGCTAGATCAAGAAGAGGAGGAAGAAGATTCACCAATGATCAGTTGGCAGGGGGTTCTCGTGGGTTACGGTTGTGGACTTGTTATTGGACTATCCGTAATATACATAATGTGGTCAACTCAATATCCAGCATGGTTTTCGAGGATGGATTTAAAGTTGGAACACATGATTACTACGAGAATGAAAAAGCACAAGAAAAGATATTAGTGAGTAGCTATACCTCCAGGTATTCAACTTTTTATATATCAATGTATTTTCATCCTCAAAGCTCTTACCTTTAATTCTTATTGCAGGATTCATGTCGACAAAGTTTCTGAAGATGCAGATAAAATCCTTTATCTTTCATAGTCTGTGATGTTTTCGTAATGTATTTGTTATCCTATGAATAAAAACATGACTTTTCTTCCTTTCAGACTCAAATCATAGTTTGCTTTCATTTGTCTCTGGCATGTAGATATAAATTCGACTGATAAACAAAAGTCGGACATAATGTTGAATCTTTGAAACAATCAGACGATATGTTTCATCGCTAAAGACATTGTATTGCACTCAACTCTTTCACATAGACATCATAACACAAACGTACAACACTCTACTTTAAGTTCGGAAACATAAAAATCTGTTTTACAGAGTTCGAAAATATCTTATTTCAGACTCATGATGTTCCTTCATCGAAAGATCAAAGAGACATCAGGAAAAATATTTGTAATATTCTCTACTGCCTGAGCCTCACATAGAGATCTAAGTTTCGGACGATAGAGTTACCTGATATCTCTATTGATGTAAAGTAGACAGCAGTACCGATTGAATTAATCGAATAGAACACAAGCTGACGTGAGAGCATCACTGTTATACAACAACAAACTACGCTTCAGCCCGAAACAATAACTTGCATAGGGACCTTCAATAATGTTCAAAGCCCAAAAGAAGATGGACATAAACACACAACTGAGTGATAGAATTCTAGTGATTGAAATTAATATGGACTTCAAACTTCATTTGGGAAGAAATCAAGCAGAAGCGCTTGACTGCAGGTGAGGTTTATCGTGATCAATTGTTATGCAGATTAATTAATTAGCAATCCGCTTCCTAATTTCAAAGTTTGGGGGTCAAGATAAAAATTCAGCTAATGAAAAGTAGAAAACTAACAGAAACACCTCTCCAAACAGACTTTGGAAGCAGATTTGCGGTGCATTTTCACCAAAATGTATCCTCCTTGATCTGTCGAGCTATGACTTAGCTGATTTTGATGAGTCGAGATTTCGTCATCAAGCTGCTGCAGTTATCAGCTCCACTAAATTAAAATGAGGGCTGGAACCTTGTGTGTTCCAGCATCTAACATTGCTTTTCTCAAACTCTACTGATGTTATATTAACAAAGATTGAATTTTATTTAACTTATATTTAAGGTGTGCAAAATGATATTTTAATAATAATAATAATTCAATTGTGAGAGGTTAATACATATTAAATATTGTAATTATATGAATACAAATATATATTAGAGAAAACTTATTGAGAATTCTAATATTTGACTAAGTAAATATTTTATAACATTTTAACTTATAGTAGGGGTAAAATGGTAATCTGATTTTGAAGTAAAAAGCTTTTCATTTTTATTATTATTATTATTATTATTAATAATAATAATAATAATAATAATAATAGGAATTAATCTAAGAAAATTCAAAAGTCATTACTTATTAATTAAACTAATTATAACTTTTTAATTTATAGGAGGGTAAAACCGTAAATAATAATAATAATAATAATAGTATGAATTAATCTAAAAAATACAAAAGTCATTAATGTTTAATTAAACTAATTATAACTTTTAAATTTATAGGAGGGTAAAATCGTAATTCAACTTTTGACTTGAGTTCTTCCCACTTATGAAAGTCGTGTAAAACAACGATATTTTTTGTGAGATGCATGTGTTATGTACAAGTCGTGGAACTTTGTGTTGTTGCTTGCATTTGAATTGAGAATTAATGCGGGATGCTTCGTACAAACTTATTGAATTTTCAACTTCAAAGGTTTTTTCCCGGTTCTATACGCAAACTAAGAAAAATTTAAATTATATAGTCTTTGGATGGTGACCTATTTGAACCTTTTTGGAAAGATGAACCCGTAATTAACGCGGCGTTCGAGGTATTTTCGGAGAAATTGAAGGAGCTTGAAGGGATAATTGATGCTAGAAATGCTGATTGTAATTTGAAGAATAGAAATGGAGCTGGAGTTATGCCTTATGAATTATTGAAACCATTTTCTGAACCTGGAATTACTGGAAAAGGTGTACCATATAGCATTTCCATTTGATTTTTAAAAAAAAAAAATTGTGAATTTTGTAATAAGATGCAATTGAAAGAAGTATATATTATAATGCAAGACAATTGTTGTAATCCTACTGGTCCAACTGTTACGGTATTGTCGTTATCTTTGAGCCTCGGTGCCTCTTCTGAACTCATTCTTGTAAGATCCCTAACTTTCTTCTTCCATTTCGATGTAAGATTCGCCTAAAGTGTAACATGTAACATATTCGTCTTTTTCAGGGGCTATGATCCGTCCGTCATGGACGTCTCGAATGTGTATTTCTTGTTTTGTAAATGCCCTTTGTAACAATATTAGTTCTAACCATCACTGCTAAAATAAAATAGGATTTAGTAAATTGACGGATAAATTTGGTAGTTGAACAACAAAATTCATCGTTAATTCTATTTGGCGACAGATTTCTGCTAACTACGAGTGAAATAACGATGGTCATCGCATTTGTTTTTTTTTTAATTTTCCTTGGCTATAATTTGAACTTGACTTGGAAGTCAAGATCTATGCACCAATCAATTTGTTTTTGGAATTTTGATTTGAAATGTCTTTTCTCAAAGTTGATGAACCAAATATTACGCTTACTATGATAGCTACCTCTTATGATTAATCAAACTTTTTTGAATTTTCAACTTTAAATGTCTTTGCCCCATTCTATACACCAACTAAGAAAAATTAAAATTACATAGTCTTTGCTTATTTGGATTAATAGGGGCATTTTTGGACCAAACTATTAGATGTATGAATATTTTGGACCAAGCTATTGACAACACGAACATTTTTAGACCAAACTATTAACTCAGAATATTTTCCGTTGAATGAATAGGTAACTAGTAGTAAATTTTTAGACCAAACTATGAAGAACATGCCATGTCTGGACTCCTGCACTGTCTTCCATCAACAGGTCAATTCTCGTGGAAAATAAGCTCGAGGTGGGGCACTATGTAAGGCGCTGTATTCAGAGTAGATTTCTAGTCTAAACTGAATGCATTAGGAAAATGACTAGGTAACTAGTACTAAATTATTTTATTTGTGCTATATATACCTCATCTAAATTATTGAATAGACACCCAAAGCAAACATCTCTTAATTAGTTTTGATCATTTTTAGTGCAGAAATGGGTTGTGTAAAACTTGTGTTTTTCATGCTATATTCCTTTCTCTGTCAACTTGCTTTCTCCTCATCCTCATCTCATTTGTGCCCGAAATATCAAGCTCTTGCTCTTCTACAGTTCAAGAACATGTTTACCGTTAATCCTGATGCTTCTTATTATTGTGAGTTTTCTCATCCAAAAACTCGTTCCTGGAACAAGAGCACAGATTGTTGCTCATGGGATGGAGTTCATTGTGACAATACAACAGGACAAGTAATTGAGCTTGATCTCCGTTGCAGCCAACTTCAAGGCAAGCTTCATTCCAATAGTAGCCTCTTTCAACTCTCCAATCTCAAAAGACTTGATTTGTCTTATAATGATTTCACTGGATCGCCCATTTCACCTAAATTTGGTGAGTTTTCAAATTTGACGCATCTTGATTTGTTTGATTCTAATTTTACGGGTATAATCCCTTCCGAAATTTCTCATCTTTCTAAACTATACGTTCTGCGTACCTCGACTGATTATCCATATGGGCTTAGTCTTGGGCCTCACAATTTTGAACTGCTCCTTAAGAACTTGACCCAATTAAGAGAGCTCAACCTTTACGATGTGAACCTCTCTTCCACCATTCCTTCCAATTTCTCTTCTCATTTAACAAATCTACGGCTTGCATACACAGAGTTACGTGGGATATTGCCCGAAAGATTCTTCCACCTTTCCAACTTAGAATCCCTTGATTTATCATTCAATCCCCAGCTCACGGTTAGGTTTCCCACAACCAAATGGAATAGCAGTGCATCACTCGTGAATTTATATCTCGCTGGTGTGAATATTGCTGATAGGATACCTGAATCATTTAGCCATCTAACTGCACTTCATAAGCTGCACATGGGTTATACTAATCTGTCAGGGCCCATTCCTAAACCTCTATGGAATCTCACCCACATAGAGAGTTTGTTCCTTGATTATAACCATCTTGAAGGACCAATTTCCCATTTCACGATATTTGAAAAGCTCAAGAGTTTATCACTTGGAAATAACAACTTTGATGGCCGTCTTGAGTTCTTATCCTTTAACAGAAGCTGGATGAAGCTTGAAAGGCTAGATTTTTCATCCAATTTCCTAACTGGTCCAATTCCATCCAATGTAAGTGGACTGCAAAACCTACAACAACTCATCTTGTCGTCAAACCACTTGAATGGGACTATACCTTCCTGGATATTCTCCCTTCCTTCACTGACAGTTTTAAACTTGAGTGATAACACTTTGAGTGGAAAAATTCAGGAGTTCAAGTCCAAAACATTATATTTCGTTAGTCTAGAACAAAATAAGCTGGAAGGTCCAATTCCAAGGTCACTCCTAAACCAGCAGTTCCTACAAGCTCTTCTCCTTTCACACAATAATATCAGTGGACATATTTCTTCAGCTATCTGCAATCTGAAAACATTCATACTACTAAATTTGAAAAGTAATAATTTGGAGGGAACAATCCCACAATGTTTGGGTGAGATGAGTGAACTTCAAGTTTTGGATTTAAGCAACAATAGTCTTAGTGGAACAATGAATACAACTTTTAGTATTGGAAACCCACTCCACATCATTAAATTGGACTGGAATAAGCTACAGGGGAAAGTCCCACCATCTTTGATCAATTGTAAGAAATTGGAACTTCTAGATTTAAGTAACAATGAGTTGAATGACACGTTTCCAAAATGGTTAGGAGACCTACCTAATTTGCAGGTTTTAAACTTTAGATCAAATAAGTTGTATGGCCCTATAAGGACTAACAACTTGTTTGCTAAAATTCGAGTCGTAGATCTCTCATCCAATGGATTTAGTGGAGATTTACCAGTGAGCTTTTTTGAGAATTTTGAAGCCATGAAAATAAATGGTGAGAACAATGGAACCCGAAAGTATGTAGCAGATCTGTATTCTGATTATTACAAAAATTATTTGATAGTGACAACGAAGGGACTGGATCAGGAACTTTCTCGAGTTTTGACTACACAAATAATTATTGATCTCTCAAAGAACAAATTTGAAGGTCATATTCCAAACATTATTGGAGATCTCATTGGACTTCGTACCTTGAACCTATCTCATAATGTCTTGGAAGGTCATATACCGGCATCATTTCAAAATTTATCAGTACTCGAATCATTAGATCTCTCATCTAACAAAATCAGCGGAGCAATTCCGCAGCAGCTTGCATCCCTCACATTCCTTGAAGTCTTAAATCTCTCTCACAATCATCTCGTTGGATGCATCCCCAAAGGAAAACAATTTGATTCGTTCGAGAACAGTTCATACCTTGGAAATGATGGATTACGAGGATTGCCACCCTCAAGAGATTGTGGCCGTGATGATCAAGTAACAACTCCAGCTGAGCTAGATCAAGAAGAAGATTCACCAATGATCAGTTGGCAAGCAGTTCTCATGGGTTACGGTTGTGGACTTGTTATTGGACTATCCGTAATATACATAATGTGGTCAACTCAATATCCAGCATGGTTTTCCAGGATGGATGTAAAATTGGAACACATCATTAGTAAAAGAATGAAAAAACACAAGAAAAGATATTAGTGTGCAGGTAATTAATCAACTTGTTTTTTATCCTTCAAAAGATTACTTCTTCAAAAGTTTTAATTCTTTATTTTTGAAAATTGCAGGATTCAAGTTGTTGAGGATGCAGTTAAATGCCTTTATCTTTCATAGTTTGTGATGTTCCCATAAATGTGTTTGTTATCCTATGAATAAAGACATGACTTTTCTTCCTTTGAGGCTCAAATCAGATTATGTTTTCATTTGTCTATGGCTTGTAGAAATACATTTGAATAATAAACAGAAATCAGACACAAACTTGAATATTTAGATCATTCAATCGGATGATGTATCATGACTAAAAACATTGTATTTCACATTAACACAAACATAGAATACTCACTGTAGTTACAAAGTTCAAAAATATTGTTTTCCAACTCATGATGGAGAAATTTTACCAGTGAGTGACTATCTTTAACTCTTTTCATTGAAGCAGCAGCAAAAAGATTTGCATTATTCTCCGCTGTCTGAGCCTCACGTAGACTGGAATCTGCATTATTTGAAGAGTTGGAGAAAGAGCCTTCAACTCTAAAAATCCAACTCCCGGATGACAGAGTTACCAGATATCTCTCTTAATGGAAGGTAGACGGTACCAGTTGAATTAATTGAATAGAACACAAGTAGACTTGAGCAGTTATACAACAACAAACTACGCGACCTGCAATAATGTTCAAACCAATAGACATAAATACAGAATTGAGTGATATAATTTCTAGTGATTGAAATTCATATGGATTTCAAACATCATTTAGGAAGAAATCAAGTAGAAGCACTTGACTATAGGTGAGGTTTATCGTGATCTACTGTTGTTCTGATTCATTAATTAGCAAACTGCTCCACAATTTCAAAGTTTCGGGGCAAAGAAAAAGATTCATAATAGCAAAAGGAAATACCTCATCAAACAGACTTAGGAACCAGGTTTGTCAAGATATCACTACAGCTTGCTTTAATCCATATGCAGGATCCTTCTAACTGACTTTGTTGAGTCGAGATTTCACAAACATGTATCTGTCATGCTATGACTTAGCTGATGCGGTAGTTATCAGCTCCACTAAATAAACTTGTGGGCTGAAACCTTGCGTATTCCAGCATCGAAAATTGCTTTTCTCAAGGCAGCAGCATAATCCCACCTCTCTGCGCCAGCACAAATGATTCCGTTGCGACTCAAGCAACAGTTGTGCTATTTCATTTTCCAATTCAATAGCTCCATGAAGTCTACAAGCACCCATCAGACAGTGGCATCAGCTTCAAAAGGCATCTTCTTTATCAAGTGTACGCTTCCTGCAGTAGTCCAGCTCTCCCTAAGAGATCAACCACACAACCATAAGTCAAAATTCATGAGACATTGCTTCAAACAATTTAAAACTGAAATATACAAGCTTGGCATGCGCACAAGCTGATAGAACAGACACAAAGGTAATCTCATTTGGTTGCAGACCCTTTGCACCTCATCTTCTCATACATCGTTAATGCATAGCTAAGGAAGAAATCATAACATGATTTTGAAACCTTTACCATTGAGCTAACTTCTAAGAAAAGGGTTGTAGATTAATTGTGATACATTCATTTCTATTCGACCTCCTTTATGATGCAAGTTACATAAATGAAAAAGTGCTAAATTAAGAAACGGAGATTTGGTATCTAGCTTAGAGAAGATTTGGGCCTCTTGAAGTGCACAACACACTGATGGCCCAATCTGCTCACGGACCCAAACCAGCAAAACAAAAGAAAATTAGAATCACATAAAATGAATCTTTAGATCATCCAATTAGACGATATGTGCACACACTAAAAACATTTGTGTTTCACTCAACTCTTTCACATAACACAAACATATAAGACTCGACTTTAAGTTCAGTAACATAAAAATCCGTAGTTATAGAGTTTGAAGATATTTTTCAACAGAATGTCTATATTAAGGGGTATCATACTCATACATAAGTAGTTATTATCATTTGAAGAGTACTTTCATGGAACTTTTTAATTCTGTGAATTTATTTCAGGAGAAGTTTAGGAAAAAAAGGCGATATGTGAATTTACTCCGGAAATTTTTAAAGGTGACCTTCATTTTTTAATTTTCTTGGTACAAATGGACCTGAGATCATGCTGAAAGATGAAGTCGATTGAAACATGTATAACTTTTAGATTTTAATGAACATTTGAAAGAAAGCAAAGTAGAACTTTTCTTAACTTCTTTAGTTTTTGTAATTGAAAGGCAAAGTTGTGTGAGTGGGGGCAGGGTTGTTAAGGGAACCAAAACCTGTTGGTGTGGGGGCAGGGTTGTTAACGGAGTAAGAAAGGTTCTGTCATAGCAAAATTCTTAAAAGACGAATTGTGAAAATAGACCATAAAACGTCGACACTACTTTAAAAAAAGTAAACTTTATTATGGAACGGAGGGAGTATCAATTTGGGACAGAAAGTAAGACCTTAAAAGAAGAAGACAAAGTAAGACCTTAAAAGAAGAAGAGAAAGTTGTGTGTGTGGAGGGTTGTTAAGAGAGCCAAAACAAAGACCTTTTTGTAAGCTATTGAATGAAAATGACCTTCCCAGAATTGATTACTCCAAAGTAATAACTAAATCTGCATAGTGAACTTCGTTCCTGAGTTTGTGCTATATATATCTCATCAAACATAATGAAACATATAGACACAGCAAACATTTCTTGATTTCTTCTCTATCAACTTAACTAGTTTTGATCATTTTAGTGCAGAAATGGATTGTGTGAAACTTATATTTTTTATGCTATATCCCTTTCTCTGTCAACTTGCTTTATCCTCATCCTCACCTCATTTGTGCCCCAAAGATGAAGCTCTTGCTCTTCTACAATTCAAGCACATGTTTACCGTTAATCCTAATGCTTCTGATTATTGTTACGACATAACAGACCAAGAGAATATCCAGTCATATCCAAGAACTCTGTCATGGAACAACAGCATAGATTGTTGCTCATGGAATGGAGTTCATTGTGACGAGACGACAGGGCAAGTGATTGAGCTTGATCTCCGTTGCAGCCAACTTCAAGGCAAGTTTCATTCCAATAGCAGCCTCTTTCACCTCTCCAATCTCAAAAGCCTTGATTTGGCTTATAATAATTTTTCTGGATCACTCATTTCACCTAAATTTGGTGAGTTCTCTGGCTTGGCGCATCTTGATTTGTCACATTCAAGTTTTACAGGTCTGATCCCAGCTGAAATCTCTCACCTTTCTAAACTACACATTCTTCGTATAGGTGATCAACATGAGCTTAGTCTTGGGCCTCACAATTTTGAACTGCTCCTTAAGAACTTGACCCAATTAAGAGAGCTCCACCTTGAATCTGTCAACATCTCTTCCACTATTCCTTCAAATTTCTCTTCTCATTTAACAACTCTACAACTTTCAGACACACAGTTACGTGGGATTTTGCCCGAAAGAGTTCTCCACCTTTCCAACTTAGAAACCCTTATTTTATCATATAACAACTTTCATGGCCAACTTGAGTTCTTATCCTTTAACAGAAGTTGGACCCGACTTGAATTGCTAGATTTTTCGTCCAATTCCCTTACTGGTCCAGTCCCATCCAATGTAAGTGGACTGCAAAACCTACTATGGCTCAGCTTGTCATCAAACCACTTGAATGGGACTATACCTTCCTGGATATTCTCCCTTCCTTCGCTAAAAGTGTTAGACTTGAGCAATAACACTTTCAGAGGAAAAATTCAGGAGTTCAAGTCCAAAACATTAAGTATCGTTACTCTTAAAGAAAATCAGCTGGAAGGTCCAATACCAAATTCACTCCTAAACACGCCAAGCCTAAGAATTCTTCTTCTTTCACACAATAATATCAGTGGACAGATTGCTTCAACTATCTGCAATCTGACAGCACTGAATGTGCTAAATTTGAGAAGTAATAATTTGGAGGGGACAATCCCACAATGTTTGGGTAAGATGAATATTTGTAAATTGGATTTGAGCAACAACAGTCTTAGTGGGACAATTAATACAAATTTTAGTATTGGAAACCAACTCAGGGTCATTAGCTTGCATGGGAATAAGCTAACAGGGAAAGTCCCACGATCTTTGATCAATTGCAAGTACTTGACACTTCTTGATCTAGGTAACAATCAGTTGAATGACACATTTCCAAACTGGTTCGGAGACCTACCTCATTTGCAGATTTTTAGCTTGAGATCAAATAAGTTTCATGGTCCTATTAAATCTTCAGGGAATACAAACTTGTTTGCGCAGCTTCAAATTCTGGATCTGTCATCCAATGGATTTAGTGGTAATTTACCAATAAGTCTTTTTGGGAATTTGCAAGCCATGAAAAAAATTGATGAGAGTACTACCCCACATTATGTGTCTGATCAATATGTTGGTTATTATGATTATTTGACGACAATTACAACAAAGGGACAAGATTATGATTCGGTTCAAATTTTGGATTCTAACATGATTATCGATCTCTCAAAGAACAGGTTTGAAGGTCACATTCCAGGCATTATTGGAGATCTCGTTGGACTTCGTACCTTGAACTTATCTCATAATGTCTTGGAAGGTCATATACCAACATCATTGCAAAATTTATCAGTACTCGAATCATTGGATCTCTCATCTAACAAAATCAGCGGAGAAATTCCGAAGCAGCTTGAATCCCTCACATTTCTTGAAGTCTTGAATCTCTCTCACAATCATCTTGTTGGATGCATTCCCACAGGAAAACAATTTGATTCGTTCGAGAACAGTTCATACCAAGGGAATGATGGGTTACACGGATTTCCACTATCAACACATTGTGGCGGTGATGATCGGGTACCACCGGCAATAACTCCAGCTGAGATAGATCAAGAAGAAGAAGAAGATTCACCAATGATCAGTTGGGAAGCAGTTCTCATGGGTTATGGCTGTGGACTTGTTATTGGACTGTCCGTAATATACATAATGTGGTCAACTCAATATCCAGCATGGTTTTCGAGGTTGGTTGTGAAATTGGAACACAAAATTACTATGAGAATGAAAAGGCACGAGGAAAGATATTAGTGTGTAACAACCTCCAGGTATTTCAACTTGAATTTTATCCTTCAGAAGATTATTTTTTATATATCAATGTAATATCTACATACTTTATCATTAAAGCTCTTAACTTTAATTTCTTTATTTTTGAATTTTGCAGAATTCAAGTCTACAGAGTTGCTGAAGATGCAGATAAAAGCCTTTTATCTTTTATAGTTTGTGATGTTTCCATAAAGTTTTTGTAATCCAATGAATAAAGGCATGACTTTTCTTCCATGAATCAAC'
# Tokenize the input sequences and remove the [SEP] token
seqs = dnaTokenizer.batch_encode_plus(
    [seq], 
    return_tensors="pt")["input_ids"][:, :-1]


model.eval()
if torch.cuda.is_available():
    seqs = seqs.to("cuda")
    model.to("cuda")

# Prediction
outputs = model.generate(
    inputs=seqs,  
    num_return_sequences=1, 
    max_length=2048, 
    num_beams=2,
    do_sample=True,
    decoder_input_ids = None
)

# Convert to GSF
prediction = gffTokenizer.batch_decode(
    outputs.detach().cpu().numpy(), 
    skip_special_tokens=True
)

print(prediction)

from transgenic.utils.gsf import gffString2GFF3

gff = gffString2GFF3(prediction[0], "Chr1", 1234, "gene_model=Solyc01T000065")
for i in gff:
	print(i)
